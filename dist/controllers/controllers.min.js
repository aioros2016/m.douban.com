angular.module("singlePage",["ngRoute","mainMod","movieMod","bookMod","radioMod","teamMod"]).config(["$routeProvider",function($routeProvider){$routeProvider.when("/main",{templateUrl:"./views/main.html",controller:"mainController"}).when("/movie",{templateUrl:"./views/movie.html",controller:"movieController"}).when("/book",{templateUrl:"./views/book.html",controller:"bookController"}).when("/radio",{templateUrl:"./views/radio.html",controller:"radioController"}).when("/team",{templateUrl:"./views/team.html",controller:"teamController"}).otherwise({redirectTo:"/main"})}]).controller("indexController",function($scope){$scope.showPop=!0,$scope.iconSearch={background:"url(../../img/search2.png) no-repeat 50%","background-color":"#f3f3f3","background-size":"auto 70%"},$scope.rnd=function(n,m){return parseInt(Math.random()*(m-n)+n)},$scope.rndColor={color:"rgb("+$scope.rnd(0,255)+","+$scope.rnd(0,255)+","+$scope.rnd(0,255)+")"},$scope.quickMenu=document.querySelectorAll(".menu-box a");for(var i=0;i<$scope.quickMenu.length;i++)$scope.r=$scope.rnd(0,255),$scope.g=$scope.rnd(0,255),$scope.b=$scope.rnd(0,255),$scope.quickMenu[i].style.color="rgb("+$scope.r+","+$scope.g+","+$scope.b+")"}).directive("onFinishRender",function($timeout){return{restrict:"A",link:function(scope,element,attr){scope.$last===!0&&$timeout(function(){scope.$emit("ngRepeatFinished")})}}}),angular.module("mainMod",[]).controller("mainController",function($scope,$http){$scope.page=1,$scope.pageLen=3,$scope.arr=[],$scope.loadPage=function(){$scope.page++,$scope.getData($scope.page),console.log($scope.arr)},$scope.getData=function(page){$http.get("json/main"+page+".json").success(function(res){$scope.list=res.list;for(var json in $scope.list)$scope.arr.push($scope.list[json])}).error(function(){alert("载入失败")})},$scope.getData(1)}),angular.module("movieMod",[]).controller("movieController",function($scope,$http){$http.get("json/movie1.json").success(function(res){$scope.json=res,$scope.$on("ngRepeatFinished",function(ngRepeatFinishedEvent){$scope.swiper=new Swiper(".rank1",{slidesPerView:"auto",freeMode:!0,observer:!0,observeParents:!0,resistanceRatio:0}),$scope.swiper2=new Swiper(".rank2",{slidesPerView:"auto",freeMode:!0,observer:!0,observeParents:!0,resistanceRatio:0}),$scope.swiper3=new Swiper(".rank3",{slidesPerView:"auto",freeMode:!0,observer:!0,observeParents:!0,resistanceRatio:0}),$scope.swiper4=new Swiper(".find-movie",{direction:"horizontal",slidesPerView:"auto",freeMode:!0,observer:!0,observeParents:!0,resistanceRatio:0})})}).error(function(){alert("载入失败")})}),angular.module("bookMod",[]).controller("bookController",function($scope,$http){$http.get("json/book1.json").success(function(res){$scope.json=res,$scope.$on("ngRepeatFinished",function(ngRepeatFinishedEvent){$scope.swiper=new Swiper(".rank1",{slidesPerView:"auto",freeMode:!0,observer:!0,observeParents:!0,resistanceRatio:0}),$scope.swiper2=new Swiper(".rank2",{slidesPerView:"auto",freeMode:!0,observer:!0,observeParents:!0,resistanceRatio:0}),$scope.swiper3=new Swiper(".rank3",{slidesPerView:"auto",freeMode:!0,observer:!0,observeParents:!0,resistanceRatio:0}),$scope.swiper4=new Swiper(".find-book",{direction:"horizontal",slidesPerView:"auto",freeMode:!0,observer:!0,observeParents:!0,resistanceRatio:0})})}).error(function(){alert("载入失败")})}),angular.module("radioMod",[]).controller("radioController",function($scope,$http){$http.get("json/radio1.json").success(function(res){$scope.list=res.radio1}).error(function(){alert("载入失败")})}),angular.module("teamMod",[]).controller("teamController",function($scope,$http){$http.get("json/team1.json").success(function(res){$scope.arr=res}).error(function(){alert("载入失败")}),$scope.getDateDiff=function(dateTimeStamp){var minute=6e4,hour=60*minute,day=24*hour,month=30*day,now=(new Date).getTime(),diffValue=now-dateTimeStamp;if(!(diffValue<0)){var monthC=diffValue/month,weekC=diffValue/(7*day),dayC=diffValue/day,hourC=diffValue/hour,minC=diffValue/minute;return monthC>=1?result=""+parseInt(monthC)+"月前更新：":weekC>=1?result=""+parseInt(weekC)+"周前更新：":dayC>=1?result=""+parseInt(dayC)+"天前更新：":hourC>=1?result=""+parseInt(hourC)+"小时前更新：":minC>=1?result=""+parseInt(minC)+"分钟前更新：":result="刚刚更新：",result}}});